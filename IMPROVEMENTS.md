# Доработки проекта healthkit-diabetes

## 1. Надёжность и качество кода

- [x] **Обработка ошибок** — добавить try/except при парсинге XML и конвертации значений, чтобы приложение не падало на некорректных данных
- [x] **Type hints** — добавить аннотации типов к функциям
- [ ] **Разбивка на модули** — разделить монолитный `healthkit_diabetes.py` (310 строк) на отдельные файлы:
  - `parser.py` — парсинг XML
  - `plot.py` — построение графиков
  - `app.py` — UI (Streamlit)
- [ ] **Unit-тесты** — написать тесты для парсера и логики фильтрации данных

## 2. Новые функции

- [ ] **Сводная статистика** — блок с ключевыми показателями за выбранный период:
  - среднее/мин/макс глюкозы
  - суммарный инсулин (базальный + болюсный)
  - суммарные углеводы
  - % времени в целевом диапазоне (Time in Range)
- [ ] **Настраиваемые пороги глюкозы** — позволить пользователю задавать целевой диапазон (сейчас захардкожено 3.9–10.0 ммоль/л)
- [ ] **Экспорт данных** — кнопка для скачивания отфильтрованных данных в CSV
- [ ] **Анализ корреляций** — визуализация связи между приёмами пищи и скачками глюкозы
- [ ] **Почасовые метки на оси X** — сейчас на таймлайне отображаются только 0:00 и 12:00, добавить промежуточные часовые метки (например каждые 2–4 часа) для удобной навигации по суткам

## 3. DevOps / конфигурация

- [x] **Makefile для Linux/macOS** — сейчас команды рассчитаны на Windows (используется `python` вместо `python3`, пути с `\`)
- [ ] **Конфигурация через переменные окружения** — путь к `export.xml` сейчас захардкожен, вынести в `.env` или аргумент командной строки
- [ ] **Логирование** — добавить `logging` вместо `print` для отладки

## Приоритеты

| Приоритет | Задача |
|-----------|--------|
| ~~Высокий~~ | ~~Обработка ошибок~~ ✓ |
| ~~Высокий~~ | ~~Makefile для Linux/macOS~~ ✓ |
| Средний | Сводная статистика (Time in Range) |
| Средний | Настраиваемые пороги глюкозы |
| Средний | Разбивка на модули |
| Низкий | Unit-тесты |
| Низкий | Экспорт в CSV |
| Низкий | Анализ корреляций |
